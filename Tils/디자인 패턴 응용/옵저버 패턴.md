# 옵저버 패턴

특정 객체의 변화에 대응하는 행동을 하기 위해서는 어떻게 해야 할까?

예를들어 플레이어의 체력이 감소된 순간, 피격 사운드를 재생하고 싶다고 하자.

그렇다면 사운드 플레이어는 매 업데이트 프래임 마다 플레이어의 hp 변화를 확인해야 할까?

<br>

## 역할의 변경과 콜백

업데이트 틱을 관찰하는데에 계속 사용하는것은 성능상으로 매우 큰 낭비를 가져온다. 그렇다면 역할을 반대로 바꿔보도록 하자.

사운드 플레이어가 관찰하는것이 아닌, 플레이어가 체력이 소모된 경우에, 해당 상태를 알리는것이다.

이러한 상황이 발생하면 사운드 플레이어의 피격음을 내는 함수를 작동시켜줘! 하고 맡겨두는 방식을 사용하면 연산 낭비를 줄일 수 있다.

이러한 구조의 함수를 **콜백함수**라고 하며, 이런 관찰자가 많은 구조를 **옵저버 패턴**이라고 한다.

<br>

### 주시 대상 ( Subject )

관찰 대상을 의미하며, 특정 상태변화시, 등록된 콜백함수들을 실행하는 역할을 한다.

<br>

### 구독자 ( Observer )

관찰자를 의미하며, 주시 대상에게 관찰행동, 대응 콜백함수를 전달하여 현상이 일어났을 때 실행할 행동을 전달한다.

<br>
### 단위 상세 항목

<br>

## 유의점

패턴을 사용할 때에는 항상 유의사항이 따라온다.
<br>
### 이벤트 구독과 해제의 타이밍

콜백을 실행해야하는 시점을 정확히 이해하고, 언제 구독을 해야할 지, 언제 구독을 해제해야 할 지 확실하게 작성해주어야 한다.

특히, 구독 해제를 깜빡할 경우, GC가 해당 옵저버 객체를 해제하지 않는 현상이 발생할 수 있다.

<br>

### 구조 복잡도 증가

옵저버 패턴은 단방향성을 가진다. 즉, 옵저버는 관찰 대상이 누군지 알 수 있지만, 관찰 대상은 어느 옵저버가 등록되어있는지 직관적으로 알 방법이 없다.

즉, 구조적인 직관성이 떨어질 수 있고, 오류를 발견하기 어려워질 수 있다.

<br>