# 빛

빛을 구현하는데에는 항상 조심해야 한다.
현실에서는 빛이 비춰지는데 연산이 필요 없지만 게임에서는 연산이 필요하기 때문이다.

대체 무슨일이 일어나는지 알아보자.

<br>

## 빛의 역산

개념적으로는 설명하기 힘들지만, 보통 그래픽에서 빛을 표현하는데에는 레이 트래이싱이라는 기법을 사용한다.

빛의 출력은 실수의 범위와 같다. 0과 1 사이에 무한한 숫자가 존재하는것처럼 빛이 비춰지는 각도는 무한하기 때문에 광원에서 출발하는 모든 광선을 계산하는것은 사실상 불가능하다.

따라서 밝기값이 필요한 부분부터 광원으로 향하는 벡터를 찾아내서 이를 통해 근사값을 계산하여 밝기를 정하는 방식을 사용한다.

<br>

## 유니티와 직사광선

유니티에서는 directional light 즉, 비춰지는 각도가 일정한 빛을 가장 많이 사용한다.

빛이 확산되지 않으므로 폴리곤의 법선백터만으로 어느정도의 연산이 가능하며, 특히 유니티는 bake라는 개념을 이용한다.

실행 전에 빛에 의한 밝기등을 미리 계산한 뒤에, 사물들의 이동에 의한 밝기 변화가 없다면 계속 밝기를 재계산할 필요가 없기 때문이다.

<br>

## bake

빛을 연산하는데에는 엄청난 연산이 필요하다고 했다.

하지만 가로등처럼 언제나 같은 빛의 출력이 생기는 장소같은경우, 계속해서 실시간으로 연산할 필요가 없다.

이럴때 빛의 옵션은 bake로 설정할 수 있다.

+) 이러한 경우에는 주변 구성요소의 속성을 static으로 설정해야 해당 항목이 움직이지 않음을 보장할 수 있다.

<br>

### lighting window

빛을 미리 구워두는 방법을 통해 scene마다 소모되는 baking시간을 줄여두는 방법이다.

light resolution정도는 해상도를 뜻하기 때문에 너무 고해상도로 한다면 시간이 오래걸리게 된다.

<br>
### reflection probe

미리 bake해둔 경우, mixed로 하더라도 반사광에 대한 처리는 할 수 없을것이다. 이럴때를 위해 reflection probe를 정의해두고 반사결과를 미리 연산할 영역을 정의해놓고 빛을 굽는다면 해당 영역 내의 물체들에 대한 반사광을 미리 계산해놓을수 있다.

<br>

### light probe

미리 bake해두는것은 그냥 빛만이 아니다.

영역을 미리 지정해두고 빛의 영역을 bake해둔다면 다른 물체가 해당 영역에 들어왔을 때 영향을 받을 빛의 크기와 색을 미리 계산해놓을 수 있다.

실시간으로 하는것이 아닌 고정된 빛에 대한 연산이므로 bake가 되는 경우이다.

<br>

### 기본 빛 제거하기

유니티의 기본 세팅에는 스카이박스에 의한 주변광이 기본으로 세팅되어있다.

완전히 빛을 어둡게 하고싶다면 light세팅에서 해당 주변광과 skybox를 비활성화해주면 된다.

source를 color로 변경해준 뒤, 검은색으로 바꾸어주면 암전을 구현할 수 있다.

<br>